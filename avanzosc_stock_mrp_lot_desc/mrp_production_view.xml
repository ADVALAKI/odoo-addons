<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

		<act_window domain="[('production_id', '=', active_id)]"
			id="act_mrp_order_to_picking" name="Internal Picking" res_model="stock.picking"
			groups="base.group_extended" src_model="mrp.production" />

		<record id="action_mrp_to_picking_view" model="ir.actions.act_window.view">
			<field name="view_mode">tree</field>
			<field name="view_id" ref="mrp_production_form_view_inherit" />
			<field name="act_window_id" ref="act_mrp_order_to_picking" />
		</record>

		<!--
			================================ 
			MRP Production Form Inheritance
			================================
		-->

		<record id="mrp_production_form_view_inherit" model="ir.ui.view">
			<field name="name">mrp.production.inherit</field>
			<field name="model">mrp.production</field>
			<field name="type">form</field>
			<field name="inherit_id" ref="mrp.mrp_production_form_view" />
			<field name="arch" type="xml">
				<xpath expr="/form/group/field[@name='product_qty']" position="replace">
					<field name="product_qty" on_change="onchange_product_qty(product_qty)" />
				</xpath>
				<xpath expr="/form/group/label[@string='']" position="replace">
					<field name="qty_per_lot" />
				</xpath>
				<xpath expr="/form/notebook/page/field/tree[@string='Products to Consume']/field[@name='product_uom']"
					position="after">
					<field name="prodlot_id" context="{'product_id': product_id}" />
				</xpath>
<!--				<xpath expr="/form/notebook/page/field[@name='product_lines']"-->
<!--					position="replace">-->
<!--					<field colspan="4" name="product_lines" nolabel="1" widget="one2many_list" editable="bottom"/>-->
<!--				</xpath>-->
				<xpath expr="/form/notebook/page/field/tree[@string='Products to Finish']/field[@name='product_uom']"
					position="after">
					<field name="prodlot_id" context="{'product_id': product_id}" />
				</xpath>
				<xpath expr="/form/notebook/page/field/tree[@string='Products to Finish']/button[@string='Partial']"
					position="replace">
					<button name="%(stock.track_line)d" string="Split in production lots"
						type="action" icon="gtk-justify-fill" states="draft,waiting,confirmed,assigned" />
				</xpath>
			</field>
		</record>
		
		<record id="mrp_production_product_form_view_inh" model="ir.ui.view">
            <field name="name">mrp.production.product.line.form.inh</field>
            <field name="model">mrp.production.product.line</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="mrp.mrp_production_product_form_view" />
            <field name="arch" type="xml">
                <field name="product_uom" position="after">
            		<field name="location_id" />
            	</field>
            </field>
        </record>
        
        <record id="mrp_production_product_tree_view_inh" model="ir.ui.view">
            <field name="name">mrp.production.product.line.tree.inh</field>
            <field name="model">mrp.production.product.line</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="mrp.mrp_production_product_tree_view" />
            <field name="arch" type="xml">
            	<tree string="Scheduled Products" position="replace" >
	            	<tree string="Scheduled Products" editable="bottom" >
	                    <field name="product_id"/>
	                    <field name="product_qty"/>
	                    <field name="product_uom"/>
	                    <field name="location_id" />
	                    <field name="product_uos_qty" groups="product.group_uos"/>
	                    <field name="product_uos" groups="product.group_uos"/>
	                </tree>
                </tree>
            </field>
        </record>

	</data>
</openerp>